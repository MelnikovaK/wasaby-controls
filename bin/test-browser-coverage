#!/bin/sh
# Run unit testing via browser

node -v
npm install

paths=(Controls components)

for item in ${paths[*]}
do
    mkdir -p ara/${item}
    cp -rf ${item}/* ara/${item}/
done

#node node_modules/nyc/bin/nyc instrument ara goga

#for item in ${paths[*]}
#do
#    mv ${item} ${item}-origin
#    mv goga/${item} ${item}
#    cp -nR ${item}-origin/* ${item}
#done
#rm -rf ara/
#rm -rf goga/

#node depencyCollector
#node node_modules/ws-unit-testing/queue test-server test-browser-coverage

#rm -rf Controls
#rm -rf components
#mv Controls-origin Controls
#mv components-origin components

#node coverageUnusedFiles

#mkdir artifacts/components
#mv artifacts/coverageComponents.json artifacts/components/coverage.json
#mkdir artifacts/controls
#mv artifacts/coverageControls.json artifacts/controls/coverage.json
#mkdir artifacts/all
#mv artifacts/coverageAll.json artifacts/all/coverage.json

#node node_modules/nyc/bin/nyc report --reporter=cobertura --report-dir=cobertura --temp-directory=artifacts/all
#node node_modules/nyc/bin/nyc report --reporter=html --report-dir=coverage-report --temp-directory=artifacts/all
#node node_modules/nyc/bin/nyc report --reporter=html --report-dir=coverage-controls-report --temp-directory=artifacts/controls
#node node_modules/nyc/bin/nyc report --reporter=html --report-dir=coverage-components-report --temp-directory=artifacts/components