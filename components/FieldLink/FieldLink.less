.controls-FieldLink {
   .controls-TextBox__beforeFieldWrapper {
      .inline-flexbox();
      .flex-shrink(0);
      .flex-direction(row-reverse);
      max-width: calc(100% ~'-' 20px); //todo
      overflow: hidden;
   }
   .controls-FieldLink__linksWrapper {
      min-width: 0;
      overflow:hidden;
   }
   &.ws-disabled {
      .controls-TextBox__beforeFieldWrapper {
         max-width: 100%;
      }
      //todo:
      .controls-Link.controls-FieldLink__showAllLinks {
         &:after {
            content: '';
            position: absolute;
            right: -@controls-FieldLink-showAll-shadow-width;
            width: @controls-FieldLink-showAll-shadow-width;
            top: 0;
            bottom: 0;
            .horizontal-gradient(@white-color, rgba(255, 255, 255, 0));
            background-color: transparent;
         }
      }

   }
   &.controls-FieldLink__selected-single {
      .controls-FieldLinkItemsCollection {
         .justify-content()
      }
   }
}

.controls-FieldLink__picker {
   max-height: @controls-FieldLink-picker-max-height;
   min-height: @controls-FieldLink-picker-min-height;
   border: @controls-FieldLink-border @gray-ccc-color;
   margin-top: 0;
   overflow: auto;
}
.controls-FieldLink__fieldWrapper {
   .inline-flexbox();
   position:relative;
   height: 100%;
   width: 100%;
   line-height: 20px !important;
   text-decoration: inherit;
   margin-right: @controls-FieldLink-fieldWrapper-margin;
}
.controls-FieldLink__picker:not(.controls-Suggest__picker) {
   padding: @controls-FieldLink-linkContainer-padding;
   border-top: none;
   .flexbox();
   .flex-wrap(wrap);

   .controls-FieldLink__item {
      /* Учитываем бордер пикера */
      width: ~'calc(50% - 2px)';
      .inline-flexbox();
      align-items: center;
      margin: 0;
      padding: 0;

      &:after {
         content: none;
      }

      .controls-FieldLink__item-cross {
         position: static;
         padding: 0;
      }

      .controls-FieldLink__item-caption {
         .text-overflow();
         height: @controls-FieldLink-linkItem-line-height;
      }
   }

   &.controls-popup-revert-vertical {
      border-top: @controls-FieldLink-border @gray-ccc-color;
      border-bottom: none;
   }
}

.controls-FieldLink__item {
   cursor: @controls-FieldLink-linkItem-cursor;
   display: inline-block;
   margin: @controls-FieldLink-linkItem-margin;
   position: @controls-FieldLink-linkItem-position;
   padding: @controls-FieldLink-linkItem-padding;
   line-height: @controls-FieldLink-linkItem-line-height;

   &:after {
      position: absolute;
      right: 0;
      top: 0;
      content: ',';
   }
   &:last-child:after {
      content: '';
   }
}

.controls-FieldLink__item-caption {
   height: @controls-FieldLink-linkItem-caption-height;
   font-size: @default-font-size;
}

.controls-FieldLink__item-cross {
   position: absolute;
   right: @controls-FieldLink-linkItem-cross-right;
   top: @controls-FieldLink-linkItem-cross-top;
   padding: @controls-FieldLink-linkItem-cross-padding;
   cursor: @link-cursor;
   z-index: 1;
}

.controls-FieldLink__picker,
.controls-FieldLink {
   &.ws-disabled {
      .controls-FieldLink__item-cross {
         display: none;
      }
   }
}

.controls-FieldLink__itemsEdited {
   .controls-FieldLink__item-caption:hover {
      text-decoration: @link-hover-text-decoration;
      cursor: @link-cursor;
   }
}

.controls-FieldLink__itemsBold {
   .controls-FieldLink__item-caption {
      font-weight: bold;
   }
}

.controls-FieldLink__hideSelector {
   .controls-FieldLink__showSelector {
      display: none;
   }
}

.controls-FieldLink__big-fontSize {
   .controls-FieldLink__item-caption {
      font-size: @controls-FieldLink-big-fontSize;
      font-weight: bold;
      color: @controls-FieldLink-big-fontSize-color;
   }
}

.controls-FieldLink {
   position: relative;
   white-space: nowrap;
   
   &.controls-Picker__show:not(.ws-disabled) {
      border-color: @controls-FieldLink-border-color-picker-show;
   }

   &:not(.controls-FieldLink__multiselect),
   &.controls-FieldLink__selected-single {
      .controls-FieldLink__linksWrapper {
         max-width: 100%;
      }
      .controls-FieldLink__item {
         /* Учитываем отступ под крестик удаления */
         max-width: ~'calc(100% - '@controls-FieldLink-linkItem-cross-width~')';
      }

      &.ws-disabled {
         .controls-FieldLink__item {
            max-width: ~'calc(100% - '@controls-FieldLink-linkContainer-padding * 2~')';
            padding: @controls-FieldLink-disabled-item-single-padding;
            margin: @controls-FieldLink-disabled-item-single-margin;
         }
      }
   }

   &.controls-Picker__show {
      background: @controls-FieldLink-picker-show-color;
      .controls-TextBox__field {
         color: @controls-FieldLink-picker-show-field-color
      }
   }

   &.ws-validation-error {
      .controls-TextBox__afterFieldWrapper {
         background-color: @text-box-error-bg;
      }
   }

   &.ws-disabled {

      .controls-TextBox__field {
         .hiddenPlaceholder();
      }

      .controls-FieldLink__item {
         padding: @controls-FieldLink-disabled-item-padding;
      }

   }

   .controls-FieldLink__dropAllLinks {
      color: @controls-FieldLink-link-color;
      display: none;
   }

   .controls-FieldLink__Link {
      display: inline;
      line-height: @default-base-line-height;
   }
}

.controls-FieldLink__selected-single:not(.controls-FieldLink__multiselect):not(.controls-FieldLink__inputMinWidth) {
   .controls-TextBox__placeholder {
      display: none;
   }
   .controls-TextBox__field {
      .hiddenPlaceholder();
   }
}

.controls-FieldLink:not(.ws-disabled) .controls-TextBox__afterFieldWrapper {
   .inline-flexbox();
   .align-items(center);
   height: 100%;
   width: auto;
}

.controls-TextBox__afterFieldWrapper {
   .controls-FieldLink__dropAllLinks, .controls-FieldLink__showSelector {
      padding: @controls-FieldLink-afterField-padding;
   }
}

.controls-FieldLink__selected-single:not(.controls-FieldLink__multiselect) .controls-TextBox__placeholder {
   display: none;
}

.ws-enabled.controls-FieldLink__inputMinWidth .controls-FieldLink__fieldWrapper {
   /* https://developer.mozilla.org/en-US/docs/Web/CSS/--*
      т.к. min-width нужен только для темизации, то делаю его
      через custom property */
   --min-width: @controls-FieldLink-fieldWrapper-minWidth;
}

.controls-FieldLink__selected:not(.controls-FieldLink__multiselect):not(.controls-FieldLink__inputMinWidth) .controls-FieldLink__fieldWrapper {
   visibility: hidden;
   width: 0;
}

.controls-Link.controls-FieldLink__Link {

   &:not(.controls-FieldLink-Link__filterButton):not(.ws-disabled) {
      color: @controls-FieldLink-link-color;
      text-decoration: underline;

      &:hover:not(.controls-Link__disabledHover) {
         color: @controls-FieldLink-link-color-hover;
      }
   }
   &:not(.ws-disabled) {
      &.controls-FieldLink-Link__filterButton {
         color: @controls-FieldLink-FilterButton-color;
         text-decoration: none;

         &.ws-enabled:hover:not(.controls-Link__disabledHover) {
            color: @controls-FieldLink-FilterButton-color-hover;
            text-decoration: underline;
         }
      }
   }
}

.controls-FieldLink__linksWrapper {
   height: 100%;
   display: inline-block;
}

.controls-FieldLinkItemsCollection {
   .justify-content(flex-end);
   display: inline-flex;
   width: 100%;
   height: 100%;
   .controls-FieldLink__item {
      .text-overflow();
       .flex-shrink(0);
   }
}

.controls-Link.controls-FieldLink__showAllLinks {
   position: relative;
   width: 20px;
   line-height: @controls-FieldLink-showAllLinks-lineHeight;
   padding: @controls-FieldLink-showAllLinks-padding;
   display: inline-block;
   .flex-shrink(0);
}



.controls-FieldLink__selected:not(.controls-FieldLink__selected-single) .controls-FieldLink__dropAllLinks {
   display: inline-block;
}


.ws-is-firefox {
   .controls-FieldLink {
      vertical-align: middle;

      .controls-FieldLink__item-cross {
         top: -1px;
      }


   }
}

.controls-FieldLink__hiddenIfEmpty.ws-disabled:not(.controls-FieldLink__selected) {
   display: none;
}

.ws-is-mobile-chrome-ios, .ws-is-mobile-safari {
   .controls-FieldLink__picker {
      &.controls-popup-revert-vertical {
         &:not(.controls-Suggest__picker) {
            border-top: none;
         }
         border-bottom: @controls-FieldLink-border @gray-ccc-color;
      }
   }
}

.ws-is-ie10 {
   /* ie10 не поддерживает custom property */
   .ws-enabled.controls-FieldLink__inputMinWidth .controls-FieldLink__fieldWrapper {
      min-width: @controls-FieldLink-fieldWrapper-minWidth;
   }
   
   .controls-FieldLink__picker:not(.controls-Suggest__picker) .controls-FieldLink__item-caption {
      display: inline-block;
      max-width: ~'calc(100% - '@icon-width~');'
   }
}
/* Почему то сафари неправильно рендерит шрифт и считает  1px === 2px, т.е. при прибавлении ширины в 1px
   реальная ширина увеличивается на 2px */
.ws-is-desktop-safari, .ws-is-mobile-safari, .ws-is-mobile-chrome-ios {
   .controls-FieldLink.controls-FieldLink__selected-single.ws-disabled .controls-FieldLink__item{
      max-width: ~'calc(100% - '(@controls-FieldLink-linkContainer-padding * 2) - 1~')';
   }
}

.controls-FieldLink__showSelector {
   color: @controls-FieldLink-showSelector-color;
}

.ws-is-desktop-platform .controls-FieldLink__showSelector:hover {
   color: @controls-FieldLink-showSelector-color-hover;
}
