{{var
    subItems,
    item = it.item,
    className = item.get('className') || '',
    itemKey = item.get(it.keyField),
    visible = !!(item.get('showType') == it.showType.MENU_TOOLBAR || item.get('showType') == it.showType.TOOLBAR );
    if (visible) {
        subItems = it.getSubItems(itemKey, null, it.items, it.keyField, it.hierField);
        subItems = $ws.core.clone(subItems);
        for (var i = 0; i < subItems.length; i++) {
            if (subItems[i].parent == itemKey ) {
                delete subItems[i].parent;
            }
        }
    }
}}
<component data-component="{{=item.get('componentType').substr(3)}}"
           data-hash="{{=it.projItem.getHash()}}"
           data-id="{{=itemKey}}"
           class="controls-ListView__item js-controls-ListView__item controls-ToolBar__item {{=className}}">
    <option name="visible" type="boolean">{{=visible}}</option>
    {{?item.get('icon')}}<option name="icon">{{=item.get('icon')}}</option>{{?}}
    {{?item.get('caption')}}<option name="caption">{{=item.get('caption')}}</option>{{?}}
    {{?item.get('command')}}<option name="command">{{=item.get('command')}}</option>{{?}}
    {{?visible && subItems.length}}
        <option name="items" type="boolean">{{=subItems}}</option>
        <option name="keyField" type="boolean">{{=it.keyField}}</option>
        <option name="hierField" type="boolean">{{=it.hierField}}</option>
        <option name="displayField" type="boolean">{{=it.displayField}}</option>
    {{?}}
</component>