<div>
   <ws:if data="{{ _options.resourceRoot && boomCfg }}">
      <script type="text/javascript">
         var startTime = -1,
            lastLongTickTime = -1,
            ticks = -1;

         function sendTick() {
            setTimeout(checkTick, 10, Date.now());
         }

         function checkTick(time) {
            var currentTime = Date.now();
            if (currentTime - time > 20) {
               lastLongTickTime = currentTime;
            } else if (currentTime - lastLongTickTime > 10000) {
               clearInterval(ticks);
               document.dispatchEvent(new CustomEvent('fullLoadTime', { 'detail':  lastLongTickTime - startTime }));
            }
         }

         function startTimeTester (){
            startTime = lastLongTickTime = Date.now();
            if (ticks !== -1) {
               clearInterval(ticks);
            }
            ticks = setInterval(sendTick, 10);
         }

         function startBoomerang(){
            BOOMR.init({{ boomCfg }});
            startTimeTester();
         }
      </script>
      <script
         type="text/javascript"
         src="{{ _options.resourceRoot }}View/Runner/Vdom/third-party/boomerang.js"
         onload="startBoomerang()">
      </script>
   </ws:if>
</div>