<?xml version="1.0" encoding="WINDOWS-1251"?>
<converter_library version="1.02">

  <converter abstract="0" call_once="1" deployment_stage="0" for_new_db="0" last_changed="Буравлев М.С." name="УходОтФайликовЛогирования" python_extension="1" responsible="Буравлев М.С.">
    <callback event="1">
      <body>if context['schema'] != 'public':
  return

SqlQuery( """DROP FUNCTION cfg(text) CASCADE;""" )
SqlQuery( """ALTER TABLE "log.$Пользователь" RENAME TO "log.$Пользователь_старая";""" )
SqlQuery( """ALTER TABLE "log.$Изменение" RENAME TO "log.$Изменение_старая";""" )
SqlQuery( """ALTER SEQUENCE "log.$Изменение_@$Изменение_seq" RENAME TO "log.$Изменение_@$Изменение_seq_old";""" )
SqlQuery( """ALTER SEQUENCE "log.$Пользователь_@$Пользователь_seq" RENAME TO "log.$Пользователь_@$Пользователь_seq_old";""" )
SqlQuery( """ALTER TABLE "log.$Изменение_старая" DROP CONSTRAINT "log.$Изменение_pkey";""" )
SqlQuery( """ALTER TABLE "log.$Пользователь_старая" DROP CONSTRAINT "log.$Пользователь_pkey";""" )</body>
    </callback>
  </converter>

  <converter abstract="0" call_once="1" deployment_stage="0" for_new_db="0" last_changed="Буравлев М.С." name="УходОтФайликовЛогированияПосле" python_extension="1" responsible="Буравлев М.С.">
    <callback event="26">
      <body>if context["schema"] == "public":
   SqlQuery( "SELECT setval( '" + context["schema"] + """."log.$Изменение_@$Изменение_seq"', ( select last_value + 100000 from public."log.$Изменение_@$Изменение_seq_old" ) );""" )
   SqlQuery( "SELECT setval( '" + context["schema"] + """."log.$Пользователь_@$Пользователь_seq"', ( select last_value + 100000 from public."log.$Пользователь_@$Пользователь_seq_old" ) );""" )
else:
   SqlQuery( "SELECT setval( '" + context["schema"] + """."log.$Изменение_@$Изменение_seq"', ( select last_value + 100000 from public."log.$Изменение_@$Изменение_seq" ) );""" )
   SqlQuery( "SELECT setval( '" + context["schema"] + """."log.$Пользователь_@$Пользователь_seq"', ( select last_value + 100000 from public."log.$Пользователь_@$Пользователь_seq" ) );""" )</body>
    </callback>
  </converter>

</converter_library>
