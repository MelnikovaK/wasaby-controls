
* 29.08.2011 начато ведение истории

* Устранена ошибка порядка загрузки объектов из наследуемых модулей.

* Устранена ошибка порядка загрузки объектов из наследуемых модулей.

*  Добавлена функция sbis::md5 для вычисления хэша

*  Серьёзно упрощена работа с методом Object::List(). Аргументы сортировки и навигации передаются не в рекордсетах, а как есть: вектор структур сортировки и структура навигации, обе структуры с удобным конструктором.

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Добавлен конструктор по умолчанию в Record. Изменена сигнатура методов Создать и Прочитать, теперь они возвращают unique_ptr<Record>, последний аргумент такого же типа в обоих методах убран.

*  Идентификатор "SessionID" переименовали в "sid".
Изменен фоормат идентификатора сессии см. http://inside.sbis.ru/doc/_layouts/DocIdRedir.aspx?ID=SBIS-5-884.
Изменилаь структура таблиц и клиентский интерфейс сервиса САП.
Модуль "БазоваяАутентификация" переименован в "Базовая аутентификация".
Модуль "Аутентификация" переименован в "Пользователи и маршрутизация".

*  Введено расширение редактирования как аргумент метода Создать. Добавлены данные для тестирования расширения.

*  Добавлена функция ClientIdBySessionId и САП.ПолучитьИмяКлиента


*  Добавлена функция ClientIdBySessionId и САП.ИдентификаторКлиента,
САП.ИдентификаторПользователя в ORX


*  Тес для функций ClientIdBySessionId, UserIdBySessionId, САП.ИдентификаторКлиента и
САП.ИдентификаторПользователя


* добавлена возможность прерывать выполнение обработчиков генерируемых методов 

*  Переделаны зависимости модулей:
1) Убрана зависимость модуля "Бизнес-логика" от "Пользователеи и маршрутизация".
2) Добавлены зависимости модулям
 - "Авторизация" от "Бизнес-логика"
 - "Пользователи и маршрутизация" от "Бизнес-логика" и "Работа с БД"
 - "Базовая аутентификация" от "Бизнес-логика"

*  Переделаны зависимости модулей:
1) Убрана зависимость модуля "Бизнес-логика" от "Пользователи и маршрутизация".
2) Добавлены зависимости модулям
 - "Авторизация" от "Бизнес-логика"
 - "Пользователи и маршрутизация" от "Бизнес-логика" и "Работа с БД"
 - "Базовая аутентификация" от "Бизнес-логика"

*  Переделаны зависимости модулей:
1) Убрана зависимость модуля "Бизнес-логика" от "Пользователи и маршрутизация".
2) Добавлены зависимости модулям
 - "Авторизация" от "Бизнес-логика"
 - "Пользователи и маршрутизация" от "Бизнес-логика" и "Работа с БД"
 - "Базовая аутентификация" от "Бизнес-логика"

* добавлена возможность прерывать выполнение обработчиков генерируемых методов


*  Исправлена функция генерации хранимой процедуры "ПерсональныеДанные.Развернуть"

* в обработчики методов "Создать" и "Записать" добавлен параметр 


*  При развертывании персональной схемы таблицам с идентификаторами назначаются последовательности созданные в соответствующей схеме.

*  При конвертации БД в режиме "Мультитенанси" хранилка "ПерсональныеДанные.Развернуть" больше не удаляется

*  Изменена сигнатура bool FuncList::ITrigger::Call( const IContext& ctx ) const на bool FuncList::ITrigger::Call( IContext& ctx ) const.
Добавлена механизм регистрации справочников при развороте схемы клиентов.

* реализованы обработчики генерируемых методов на SQL


* доработан механизм загрузки/обновления списка генерируемых методов


*  В случае ошибки соединения с базой данных при загрузке модулей сервис прерывает инициализацию и останавливается.
В последующих обращениях к сервису, если соединение с БД будет установлено, сервис должен корректно инцициализироваться.

* 
1) Изменился интерфейс модуля "Пользователи и маршрутизация".
2) Изменена работа функции САП.Аутентифицировать.
3) Функция "САП.ПолучитьКлиента" переименована в 
"БазовыйПользователь.ПолучитьКлиента" и перенесена
 в модуль "Пользователи и маршрутизация".
4) Исправлена ошибка метода "Прочитать" связанная с неправильным формированием связей объекта

* Доработан интерфейс модуля Базовая аутентификация.
( Автоматически генерируется окно admin.html для админской аутентификации )

* Доработана первоначальная генерация Администратора.
\Корректно устанавливается флаг "Супервизор"


*  
Функции САП.Выход, САП.ИдентификаторКлиента, САП.ИдентификаторПользователя, САП.ИмяПользователя, САП.ПолучитьИмяПользователя, САП.ПроверитьСессию переехали из модуля "Базовая аутентификация" в модуль "Пользователи и маршрутизация"

* 
1) Изменился алгоритм записи маршрутов в редис
2) Изменился интерфейс стартового окна модуля "Пользователи и маршрутизация"

*  Доработана функция "САП.ПроверитьСессию"

*  Доработана функция "САП.Аутентифицировать"
Доработан интерфейс "Пользователи и маршрутизация" ( Добавлена возможность изменить путь до сервиса "Управление облаком" по умолчанию 'admin')

*  При удалении записи из ПулаСерверов из Пользователей не удаляется связанные записи

*  Реализована поддержка сложных идентификаторов объектов для списочных методов, реализованных вручную. Это необходимо для построения списков, состоящих из разнотиповых объектов.
Добавлено поле первичного ключа и изменена структура поля иерархии.
Изменен формат передачи параметров на клиент.
Изменен тип возвращаемого поля Иерархия внутри хранимой процедуры.

*  
1) Добавлена функция Пользователь.Маршруты вместо Пользователь.ПроверкаДоступаСАП, Клиент.ПерсональныйМаршрут и Облако.ОбщиеМаршруты.
2) В модуль "Пользователи и маршрутизация" добавлена возможность задавать маршрут по умолчанию.

* изменено информирование пользователя об ошибках в обработчиках генерируемых методов

* добавлены обработчики на методы чтения файлов

*  
1) Из таблицы Сервер поля Название и IP объединены в одно
2) Добавлены валидаторы в интерфейс модуля "Пользователи и маршрутизация"

* Добавлена настройка в ini файле "УдалятьСтарыеЛоги", значение которой - число дней, за которые хранятся логи (по умолчанию логи не удаляются)


*  1) Изменился способ поведения связанных записей в таблицах Пользователь, Услуга, Роль и РолиПользователя.
2) Доработан интерфейс модуля Пользователи и маршрутизация

*  1) Изменился способ поведения связанных записей в таблицах Пользователь, Услуга, Роль и РолиПользователя.
2) Доработан интерфейс модуля Пользователи и маршрутизация

*  
1) Доработан модуль "Авторизация".
- Исправлена работа с гостем. Вместо "-10" используется реальный идентификатор клиента "Гость", получаемый в момент загрузки модуля.
2) Доработан модуль "Базовая аутентификация".
- При аутентификации по адресу '/auth/' происходит редирект на сервис по умолчанию.
3) Доработан модуль "Пользователи и маршрутизация".
- Добавлена функция "Клиент.ИдГостя"
- В диалогах "Диспетчеры" и "Хранилища сессий" добавлено поле "Доменное имя".
- Доработан обработчик диалога "СправочникРолей"

*  
1) Доработан модуль "Авторизация".
- Исправлена работа с гостем. Вместо "-10" используется реальный идентификатор клиента "Гость", получаемый в момент загрузки модуля.
2) Доработан модуль "Базовая аутентификация".
- При аутентификации по адресу '/auth/' происходит редирект на сервис по умолчанию.
3) Доработан модуль "Пользователи и маршрутизация".
- Добавлена функция "Клиент.ИдГостя"
- В диалогах "Диспетчеры" и "Хранилища сессий" добавлено поле "Доменное имя".
- Доработан обработчик диалога "СправочникРолей"

*  
Доработан модуль "Пользователи и маршрутизация".
- Доработана функция "Пользователь.Маршруты".(При пустом поле "Код" записи "Управление облаком" добавляет маршрут на сервис "admin" ).
- Логин пользователя теперь сквозной.

* 
Связь с таблицей "ПулСерверов" перенесена из таблицы "Пользователь" в "ПользовательРасширение"

*  
Доработан модуль "Пользователи и маршрутизация".
- Доработана функция "Пользователь.Маршруты".(При пустом поле "Код" записи "Управление облаком" добавляет маршрут на сервис "admin" ).
- Логин пользователя теперь сквозной.
- Связь с таблицей "ПулСерверов" перенесена из таблицы "Пользователь" в "ПользовательРасширение"


* 
Доработан алгоритм развертывания клиентских схем.
( Исправлена ошибка когда таблицы из клиентских схем использовали последовательности из схемы public )

* 
Доработан алгоритм развертывания клиентских схем.
( Исправлена ошибка когда таблицы из клиентских схем использовали последовательности из схемы public )

*  Введена новая технология создания записей - единым блоком памяти.
Значительные изменения в ряде типов sbis-lib для представления их в значении поля.

* доработан алгоритм слияния двух иерархий активных объектов (слияние генерируемых методов)

* исправлена ошибка при записи в базу полей типа Money (вместо 50.01 записывалось 50.1)

* исправлена ошибка при записи в базу полей вещественного типа (обрезалась дробная часть)

* Изменилось сообщение при неверном логине пользователя

* Изменилось сообщение при неверном логине пользователя

* 
На клиенте скрываются системные ошибки, отображаются ошибки в читаемом виде

* 
На клиенте скрываются системные ошибки, отображаются ошибки в читаемом виде
........


* Вылетает сообщение об ошибке, если пользователь пытается сконвертировать Multitenancy базу в режиме без Multitenancy

* Вылетает сообщение об ошибке, если пользователь пытается сконвертировать Multitenancy базу в режиме без Multitenancy

* 
1) Реализован функционал автоматического подбора группы серверов персонального обслуживания при создании клиента.
2) Доработан интерфейс создания группы серверов персонального обслуживания.
3) Добавлен справочник регионов
4) Убран флаг выбора записи из браузеров админки


* 
1) Реализован функционал автоматического подбора группы серверов персонального обслуживания при создании клиента.
2) Доработан интерфейс создания группы серверов персонального обслуживания.
3) Добавлен справочник регионов
4) Убран флаг выбора записи из браузеров админки


* В модуле "Пользователи и маршрутизация" Метод "Регион.Список" поменялся на "Регион.ИерархическийСписок"

* При создании клиента с уже существующим Логином выдается адекватное сообщение об ошибке
"Пользователь с таким логином уже существует! Попробуйте ввести другой логин."


* 1) В таблицу "Пользователь" добавлено поле "email".
2) Из модуля "Пользователи и Маршрутизация" теперь выделились еще два новых модуля
"Аутентификация" и "Управление облаком"
3) Удалена функция "САП.ИмяПользователя"
4) Функция "САП.ПолучитьИмяПользователя" теперь реализована на SQL
5) Функции "САП.ИдентификаторПользователя" и "САП.ИдентификаторКлиента" теперь возвращают не стороку а целое число.


* 1) В таблицу "Пользователь" добавлено поле "email".
2) Из модуля "Пользователи и Маршрутизация" теперь выделились еще два новых модуля
"Аутентификация" и "Управление облаком"
3) Удалена функция "САП.ИмяПользователя"
4) Функция "САП.ПолучитьИмяПользователя" теперь реализована на SQL
5) Функции "САП.ИдентификаторПользователя" и "САП.ИдентификаторКлиента" теперь возвращают не стороку а целое число.


*  Третий параметр метода прочитать снова принимает имя поля содержащего ссылку, а не имя ссылки. Убрана зависимость от dll boost unit test для Jinnee при сборке автотестирования (конфигурация Release_Zp1).

* Метод "Клиент.Создать" устанавливает поле "Раздел
* Добавлен метод "САП.ПолучитьИмяКлиента"


* Добавлен метод "САП.ПолучитьИмяКлиента"


*  Добавлена инициализация даты и времени значением текущей даты и времени для объектов не создаваемых в БД.

*  Добавлена инициализация даты и времени значением текущей даты и времени для объектов не создаваемых в БД.

* Убран функционал услуг из модулей "Пользователи и маршрутизация" и "Управление облаком" 


* Убран функционал услуг из модулей "Пользователи и маршрутизация" и "Управление облаком" 


* Исправлен обработчик "ОбработчикНаПередЗаписатьПользователя"

* Исправлен обработчик "ОбработчикНаПередЗаписатьПользователя"

*  Добавлена возможность добавлять формат поля сразу в формат записи методом Add(name,type) без фабрики и без копирования за одно выделение памяти методом Reserve(count).

* Исправлена ошибка модуля "Аутентификация".
(объект "Клиент" должен находиться в объекте "БазовыйПользователь")

* Добавлен новый метод САП.АутентифицироватьРасш

* Добавлен новый метод САП.АутентифицироватьРасш

* 
В модуле авторизации реализована поддержка ограничения прав на основании лицензии

* 
В модуле авторизации реализована поддержка ограничения прав на основании лицензии
........
Merged revision(s) 8945 from trunk:
Почему-то не добавились файлы...
........



* Исправлен обработчик "ОбработчикНаПередЗаписатьКлиента"

* Исправлен обработчик "ОбработчикНаПередЗаписатьКлиента"

* Объект "База данных и бизнес логика" разведены на два разных объекта.
Поле "Код" в таблице "ПулСерверов" теперь строка длинной 255 символов.


* Доработаны Функции САП "ПолучитьИмяПользователя", "ПолучитьИмяКлиента", "ЛогинПользователя"

* Доработаны Функции САП "ПолучитьИмяПользователя", "ПолучитьИмяКлиента", "ЛогинПользователя"

* Улучшена организация справочника "Структура облака".
Информация о БД задается отдельной записью.


* Функция "ПерсональныеДанные.Развернуть" переехала в модуль "Бизнес-логика".
Добавлена функция "ПерсональныеДанные.УстановитьКонтекстКлиента".
Доработан механизм развертывания клиентских схем для postgresql 9.1

* Функция "ПерсональныеДанные.Развернуть" переехала в модуль "Бизнес-логика".
Добавлена функция "ПерсональныеДанные.УстановитьКонтекстКлиента".
Доработан механизм развертывания клиентских схем для postgresql 9.1

* Доработана функция "Облако.НазваниеЭлементаОблака"

* Доработана функция "Облако.НазваниеЭлементаОблака"

* Добавлено логирование входа при вызове функции САП.АутентифицироватьРасш()

* Добавлено логирование входа при вызове функции САП.АутентифицироватьРасш()

*  Реализовано наследование прав пользователей

*  Реализовано наследование прав пользователей
........


* Снят флаг "Персональные данные" с таблиц "МетодыБизнесЛигики" и "ОбработчикиМетодов" модуля "Работа с БД"

* Снят флаг "Персональные данные" с таблиц "МетодыБизнесЛигики" и "ОбработчикиМетодов" модуля "Работа с БД"

* Функция "ПерсональныеДанные.УстановитьКонтекстКлиента" доработана для работы с репликацией. Добавлен таймер задержки

* Функция "ПерсональныеДанные.УстановитьКонтекстКлиента" доработана для работы с репликацией. Добавлен таймер задержки

*  Реализован метод "ПроверкаПрав.ДоступностьМетода"

*  Реализован метод "ПроверкаПрав.ДоступностьМетода"
........


* Функции "БазовыйПользователь.ЗадатьПароль", "БазовыйПользователь.ЗадатьХешПароля" и "БазовыйПользователь.ПроверитьПароль" перенесены в модуль "Управление облаком"

* Функции "БазовыйПользователь.ЗадатьПароль", "БазовыйПользователь.ЗадатьХешПароля" и "БазовыйПользователь.ПроверитьПароль" перенесены в модуль "Управление облаком"

*  Добавлено резервирование памяти при добавлении форматов полей в формат записи.

* В файл конфигурации добавлен параметр Multitenancy

* В файл конфигурации добавлен параметр Multitenancy

*  В проектах платформы фабрика типов FldFormatFactory заменена на новые методы Add и Append класса IRecFormat. Класс фабрики помечен как deprecated.

* Доработаны обработчики модуля "Базовая аутентификация".
Функция authenticate выделена в отдельный js файл

* Доработаны обработчики модуля "Базовая аутентификация".
Функция authenticate выделена в отдельный js файл

* Включено логирование таблицы "Пользователь"

* Включено логирование таблицы "Пользователь"

* 1) Модуль "Пользователи и маршрутизация" разделился на два новых: на "Пользователь" и на "Маршрутизация". В модуль "Пользователь" попала только одна таблица.
2) Таблица "ПользовательАутентификация" осталась только в модуле "Базовая аутентификация".
3) Добавлен модуль "Поддержка multitenancy". Теперь новые схемы клиентов разворачиваются только при выполнении сразу двух условий: 
- БД развернута в режиме multitenancy
- в папке модули присутствует модуль "Поддержка multitenancy".
4) Доработана первоначальная генерация пользователей 'Администратор' и 'Гость'



* 1Вместо параметра Multitenancy в файле конфигурации 
теперь нужно использовать модуль "Поддержка multitenancy".

* Откат до ревизии 9332

*  Добавилось чтение и запись в двоичные поля из std::vector<Byte>. Улучшен дизайн веб-страницы с отчётом о состоянии модулей сервиса.

* Убрано обращение к функции САП.Аутентифицировать при загрузке модуля "Аутентификации"

* 1) Модуль "Пользователи и маршрутизация" разделился на два новых: на "Пользователь" и на "Маршрутизация".
2) Добавлен новый модуль "Поддержка multitenancy".
3) Клиенты 'Администратор' и 'Гость' теперь создаются только при наличии модуля "Управление облаком"



* 1) Модуль "Пользователи и маршрутизация" разделился на два новых: на "Пользователь" и на "Маршрутизация".
2) Добавлен новый модуль "Поддержка multitenancy".
3) Клиенты 'Администратор' и 'Гость' теперь создаются только при наличии модуля "Управление облаком"



* 1) Модуль "Пользователи и маршрутизация" разделился на два новых: на "Пользователь" и на "Маршрутизация".
2) Добавлен новый модуль "Поддержка multitenancy".
3) Клиенты 'Администратор' и 'Гость' теперь создаются только при наличии модуля "Управление облаком"



* 1) Модуль "Пользователи и маршрутизация" разделился на два новых: на "Пользователь" и на "Маршрутизация".
2) Добавлен новый модуль "Поддержка multitenancy".
3) Клиенты 'Администратор' и 'Гость' теперь создаются только при наличии модуля "Управление облаком"



* 1) Модуль "Пользователи и маршрутизация" разделился на два новых: на "Пользователь" и на "Маршрутизация".
2) Добавлен новый модуль "Поддержка multitenancy".
3) Клиенты 'Администратор' и 'Гость' теперь создаются только при наличии модуля "Управление облаком"



* 1) Модуль "Пользователи и маршрутизация" разделился на два новых: на "Пользователь" и на "Маршрутизация".
2) Добавлен новый модуль "Поддержка multitenancy".
3) Клиенты 'Администратор' и 'Гость' теперь создаются только при наличии модуля "Управление облаком"



*  Добавлена возможность задавать параметр SetParam через std::vector<Byte> и непосредственно Binary для IProcedure и IStatement. Добавлена возможность считывания Binary своих данных по указателю во внутренний буфер.

* Пользователь "Гость" теперь доступен в справочнике клиентов.
Отменено ведение истории изменений в таблице "Пользователь"

* Поправлены зависимости модулей. Функции САП.ПолучитьИмяПользователя, САП.ПолучитьИмяКлиента, САП.ПолучитьЛогинПользователя перенесены в модуль "Пользователь" из модуля "Маршрутизация"

* Поправлены зависимости модулей. Функции САП.ПолучитьИмяПользователя, САП.ПолучитьИмяКлиента, САП.ПолучитьЛогинПользователя перенесены в модуль "Пользователь" из модуля "Маршрутизация"

* Нельзя удалить группу если к ней прикреплены клиенты

* Нельзя удалить группу если к ней прикреплены клиенты

* Добавлен новый класс исключений WarningException и шаблонная функция Warning. При использовании данной функции программа вызывает исключение, но при перехвате этого сообщения не пишется в лог ошибок

* Добавлен новый класс исключений WarningException и шаблонная функция Warning. При использовании данной функции программа вызывает исключение, но при перехвате этого сообщения не пишется в лог ошибок
Клиенты "Администратор" и "Гость" создаются только при наличии модуля "Управление облаком".
Журналирование входа/выхода пользователей снова запущено( теперь из сишного кода вызываются хранилки )

* Добавлен новый класс исключений WarningException и шаблонная функция Warning. При использовании данной функции программа вызывает исключение, но при перехвате этого сообщения не пишется в лог ошибок
Клиенты "Администратор" и "Гость" создаются только при наличии модуля "Управление облаком".
Журналирование входа/выхода пользователей снова запущено( теперь из сишного кода вызываются хранилки )

* Добавлен новый класс исключений WarningException и шаблонная функция Warning. При использовании данной функции программа вызывает исключение, но при перехвате этого сообщения не пишется в лог ошибок
Клиенты "Администратор" и "Гость" создаются только при наличии модуля "Управление облаком".
Журналирование входа/выхода пользователей снова запущено( теперь из сишного кода вызываются хранилки )

* Добавлен новый класс исключений WarningException и шаблонная функция Warning. При использовании данной функции программа вызывает исключение, но при перехвате этого сообщения не пишется в лог ошибок
Клиенты "Администратор" и "Гость" создаются только при наличии модуля "Управление облаком".
Журналирование входа/выхода пользователей снова запущено( теперь из сишного кода вызываются хранилки )

* Функции "Облако.ИдСлужебныхСерверов", "Облако.ИдОбщихСерверов", "Облако.ИдПерсональныхСерверов" переехали в модуль "Аутентификация"
из модуля "УправлениеОблаком"

* В таблицу "Регион" добавлено поле "КодРегиона".
Доработана функция "Облако.ПодобратьГруппуСерверовПерсональногоОбслуживания".

* В таблицу "Регион" добавлено поле "КодРегиона".
Доработана функция "Облако.ПодобратьГруппуСерверовПерсональногоОбслуживания".

* В модуль "Управление облаком" добавлен обработчик для объекта "Пользователь", запрещающий удалить клиентскую запись

*  Добавлена поддержка специальных значений: плюс и минус бесконечностей, неопределённой даты и времени, максимально и минимально возможных даты и времени. Инициализация, константы, сериализация и десериализация.

* В модуль "Управление облаком" добавлен обработчик для объекта "Пользователь", запрещающий удалить клиентскую запись

* Закомментарил самый долгий тест

*  Добавлена поддержка специальных значений: плюс и минус бесконечностей, неопределённой даты и времени, максимально и минимально возможных даты и времени. Инициализация, константы, сериализация и десериализация.

* В sbis-lib, в класс IContext добавилась новая статическая функция 
std::unique_ptr<IContext> IContext::CreateEmptyContext().
Которая возвращает пустой контекст.
Возвращаемый контекст способен принимать и возвращать различные параметры

* В sbis-lib, в класс IContext добавилась новая статическая функция 
std::unique_ptr<IContext> IContext::CreateEmptyContext().
Которая возвращает пустой контекст.
Возвращаемый контекст способен принимать и возвращать различные параметры

* В sbis-lib, в класс IContext добавилась новая статическая функция 
std::unique_ptr<IContext> IContext::CreateEmptyContext().
Которая возвращает пустой контекст.
Возвращаемый контекст способен принимать и возвращать различные параметры

* В sbis-lib, в класс IContext добавилась новая статическая функция 
std::unique_ptr<IContext> IContext::CreateEmptyContext().
Которая возвращает пустой контекст.
Возвращаемый контекст способен принимать и возвращать различные параметры

*  Добавлена возможность сортировать записи в RecordSet, а также менять записи местами без копирования записей.

* Выводится корректное сообщение при неправильном вводе пароля

* Выводится корректное сообщение при неправильном вводе пароля

* Новый интерфейс модуля "Управление облаком"

* При создании и обновлении записи в таблице "Пользователь" у полей "email" и "Логин" проверяются значения на ''(Пустая строка) и меняются на null.

* При создании и обновлении записи в таблице "Пользователь" у полей "email" и "Логин" проверяются значения на ''(Пустая строка) и меняются на null.
Добавлено описание методу "САП.АутентифицироватьРасш"

* Добавлено описание методу "САП.АутентифицироватьРасш"

* В метод Пользователь.Список добавлен необязательный параметр фильтрации "Имя"...

* В таблице "Регион" название поля "КодРегиона" изменено на "Код"

* В таблице "Регион" название поля "КодРегиона" изменено на "Код"

* Выдается адекватное сообщение при дублировании электронной почты у пользователя

* Поддержание примитивного шифрования пароля при отправлении запроса аутентификации к БД

*  Добавлен вызов SQL-запросов напрямую без хранимых процедур. Добавлена возможность задавать имена полей через const char*.

* Из таблицы "Пользователь" убрано поле "Пароль"

*  Исправление. Неожиданное поведение класса IniParser. Строка ";УдалятьСтарыеЛоги = 3;хранить логи только за последние три дня (по умолчанию не удалять)" при удалении комментария пыталась использовать целиком "3;хранить логи только за последние три дня (по умолчанию не удалять)" как значение по ключу "УдалятьСтарыеЛоги". Убраны все подобные возможные косяки.

*  Исправление. Неожиданное поведение класса IniParser. Строка ";УдалятьСтарыеЛоги = 3;хранить логи только за последние три дня (по умолчанию не удалять)" при удалении комментария пыталась использовать целиком "3;хранить логи только за последние три дня (по умолчанию не удалять)" как значение по ключу "УдалятьСтарыеЛоги". Убраны все подобные возможные косяки.

* Убрал привязку гостевой роли к константе "-10"

* Добавлена dll для модуля "Пользователь" (sbis-user).
Из модуля "Аутентификация" в модуль "Пользователь" перенесены функции:
ИдГостя и ТекущийПользователь.

* Добавлена dll для модуля "Пользователь" (sbis-user).
Из модуля "Аутентификация" в модуль "Пользователь" перенесены функции:
ИдГостя и ТекущийПользователь.

* Модуль "Пользователь" не зависит от редиса

* Модуль "Пользователь" не зависит от редиса

* Модуль "Пользователь" не зависит от редиса

* Модуль "Пользователь" не зависит от редиса

* Доработаны обработчики "ПередСоздать" и "ПередЗаписать" клиента/пользователя

* Доработаны методы "Облако.Список" и "Облако.ПодобратьГруппуСерверовПерсональногоОбслуживания"

* Доработаны методы "Облако.Список" и "Облако.ПодобратьГруппуСерверовПерсональногоОбслуживания"

* Перед выполнением функций "РегистратораСправочникаКлиента" выполняется функция SetupSessionVariables выставляющая переменные сессии

* Включено логирование таблицы "ПользовательАутентификация".
Доработка интерфейса модуля "Управление облаком"( Группам персональных серверов добавлен флаг "Нельзя добавлять новых клиентов" )

* Добавлен класс UserInfo в проект sbis-user

* В модуль "Пользователь" добавлены новые методы: 
"Пользователь.Текущий" и "Клиент.Текущий"

* Исправил метод "Облако.ПодобратьГруппуСерверовПерсональногоОбслуживания"

* Запись "База данных" для группы серверов "Аутентификация" и "Управление облаком" теперь не папка а узел

*  SQL-запросы теперь можно использовать как методы бизнес-логики напрямую, без хранимых процедур.

* В модуле "Маршрутизация" в таблице РолиПользователя изменено поведение при удалении связанной записи.
При создании нового клиента автоматически подбирается персональная группа серверов

* Доработан обработчик создания клиентов

* Добавлена возможность добавления группе персональных серверов сразу нескольких регионов

* В тестовых данных цистится таблица "Регион"

* В тестовых данных цистится таблица "Регион"

* Добавлена возможность добавления группе персональных серверов сразу нескольких регионов

* Доработан обработчик создания клиентов

*  Теперь SQL-запросы в Jinnee поддерживают параметры в блоке DO.

*  Теперь SQL-запросы в Jinnee поддерживают параметры в блоке DO.

* Триггер "ЗаписатьЛогин" отрезает пробелы вначале и в конце логина

* Триггер "ЗаписатьЛогин" отрезает пробелы вначале и в конце логина

* В модуле "Поддержка multitenancy" теперь входит dll-файл sbis-multitenancy300.dll.
В справочнике клиента добавился функционал служебных папок

* В модуле "Поддержка multitenancy" теперь входит dll-файл sbis-multitenancy300.dll.
В справочнике клиента добавился функционал служебных папок

* В модуле "Поддержка multitenancy" теперь входит dll-файл sbis-multitenancy300.dll.
В справочнике клиента добавился функционал служебных папок

* Добавление нескольких регионов с помощью запроса вместо хранилки

* Внутренний IP теперь текст

* Внутренний IP теперь текст

* Исправлен тест BeforeClientCreateHandlerTestCase

* В класс UserInfo добавлен метод GetAuthID() возвращающий идентификатора использованного метода аутентификации.
Добавлена функция AuthentificateForPersonalServerGroup( IContext& context, ObjectID user_id, ObjectID pool_id ).

* Временно закоментарил функцию создания служебных папок

* Новый механизм удаления клиентов в управлении облаком

* В класс UserInfo добавлен метод GetAuthID() возвращающий идентификатора использованного метода аутентификации.
Добавлена функция AuthentificateForPersonalServerGroup( IContext& context, ObjectID user_id, ObjectID pool_id ).

*  Версия ORX-файлов поднялась до "1.6" в связи с введением SQL-запросов как методов бизнес-логики.

* Из тестов убран модуль "Поддержка multitenancy"

*  Версия ORX-файлов поднялась до "1.6" в связи с введением SQL-запросов как методов бизнес-логики.

* Доработано "Автодополнение" для пользовательского логина

* Доработан фильтр служебных папок в справочнике клиентов

* Добавлена возможность задавать функции как объекты с помощью макроса REG_FUNC_CONTEXT_XX

* Добавлено анонимное пространство имен в макрос REG_FUNC_CONTEXT, чтобы не засорять общее пространство имен

*  Исправлен баг SQL-методов при вызове Invoke с несовпадающими типами параметров, а также блоком DO из C++.

*  Исправлен баг SQL-методов при вызове Invoke из C++ с несовпадающими типами параметров и блоком DO.

*  В транк добавлен проект и модуль центра обработки логов.

* Убрано дублирование кода за счет использования библиотеки Boost::Preprocessor

*  Добавлена подстановка записи в методе SQL-запроса. Добавлена фильтрация по дате в окне статистики центра обработки логов.

*  Добавлен вывод идентификатора процесса на стороне сервера БД, обрабатывающего текущее соединение.

* Доработана функция получения маршрутов.( Пользователь.Маршруты )

*  Центр обработки логов: добавлена привязка к модулю Пользователь. Настроена фильтрация по логину пользователя.

*  Добавлено получение параметра типа Record при вызове SQL-запроса через Invoke.

*  Добавлено получение параметра типа Record при вызове SQL-запроса через Invoke.

*  Добавлено поле "ВнешнийИдентификатор" в таблицу "Пользователь" модуля "Пользователь" по просьбе отдела CRM. Настройки отображения страницы состояния модулей: пути к каталогу img заменены на относительные.

*  Добавлено поле "ВнешнийИдентификатор" в таблицу "Пользователь" модуля "Пользователь" по просьбе отдела CRM. Настройки отображения страницы состояния модулей: пути к каталогу img заменены на относительные. Поправлено преобразование Record в hstore в формате PostgreSQL. Добавлена возможность преобразования Record и RecordSet в строку. Добавлена возможность цепочек задания полей методом record.Set(...).Set(...)... Поправлена ошибка с неправильным копированием Binary поля при расширении записи. Добавлен метод Reserve в класс Record, по аналогии с таким же методом в IRecFormat.



*  Версия ORX-файлов повышена до 1.7 в связи с введением методов на Python.
